<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="chart.css">
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
    </head>
    <body>
        <!-- <form action="/" method="post">
            Assets:<input type="text" name="assets">
            Debts:<input type="text" name="debts">
            <input type="submit" value="Submit">
        </form> -->
        <div class="chart-container">
            <canvas id="myChart"></canvas>
        </div>

       <script>
            const xlables = [];
            const assetsByMonth = [];
            const debtsByMonth = [];

            getData();
            async function getData(){
                const response = await fetch('finances.csv');
                const data = await response.text();
                const rows = data.split('\n');

                rows.forEach(elt => {
                    const row = elt.split(',');
                    const date = row[0]
                    xlables.push(date)
                    const assets = row[1]
                    assetsByMonth.push(assets);
                    const debts = row[2]
                    debtsByMonth.push(debts);
                    console.log(assets);
                });
            }
            const ctx = document.getElementById('myChart').getContext('2d');
            const myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: xlables,
                    datasets: [{
                        label: 'Assets',
                        data: assetsByMonth,
                        backgroundColor: [
                            'rgba(72, 143, 49, .75)',
                        ],
                        borderColor: [
                            'rgba(72, 143, 49, .75)',
                        ],
                        borderWidth: 1
                    },{
                        label: 'Debts',
                        data: debtsByMonth,
                        backgroundColor: [
                            'rgba(232, 48, 48, .5)',
                        ],
                        borderColor: [
                            'rgba(232, 48, 48, .5)',
                        ],
                        borderWidth: 1
                    },
                ]
                }
            });
        </script>
    </body>
</html>
